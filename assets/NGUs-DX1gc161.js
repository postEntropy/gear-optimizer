import{F as S,K as v,r as B,j as s,L as G,H,B as _,t as k,M as F}from"./index-DBS8pbof.js";import{n as w,G as b,T as E,k as N,l as d,j as R,d as C}from"./util-CWYRFuDd.js";import{M as D}from"./ModifierForm-BfFZFRvm.js";import{T as x,S as W}from"./TextField-2xv4FU3H.js";import{F as L,C as T}from"./SaveForm-CSoxvA8o.js";import{T as q}from"./TableHead-Bnsy9pD0.js";import{T as f}from"./TableSortLabel-BW5zzkkU.js";import"./Stack-BFE22zhZ.js";class z{constructor(e){this.ngustats=e.ngustats,this.state=e}speed(e){let t=this.ngustats[e].nguspeed;return e==="energy"?t*=w(this.ngustats,this.state,S.ENGU,{eBetaPot:2,eDeltaPot:2}):e==="magic"&&(t*=w(this.ngustats,this.state,S.MNGU,{mBetaPot:2,mDeltaPot:2})),t}bonus(e,t){return this.nbonus(e,Number(t.normal))*this.ebonus(e,Number(t.evil))*this.sbonus(e,Number(t.sadistic))}nbonus(e,t){return this.vbonus("normal",e,t)}ebonus(e,t){return this.vbonus("evil",e,t)}sbonus(e,t){return this.vbonus("sadistic",e,t)}vbonus(e,t,n){if(t.name==="Respawn")return this.respawnbonus(e,t,n);if(n<=0)return 1;if(n>1e9)return 1e9;if(isNaN(n))return 1;const o=t[e];return n<=o.softcap?1+n*o.bonus:1+n**o.scexponent*o.scbonus*o.bonus}respawnbonus(e,t,n){if(n<=0)return 1;if(n>1e9)return 1e9;if(isNaN(n))return 1;const o=t[e];if(n<=o.softcap){const r=1-n*o.bonus,c={normal:.8,evil:.925,sadistic:.925}[e];return Math.max(r,c)}const i=1-n/(n*o.scbonus+2e5)-o.scexponent,a={normal:.6,evil:.9,sadistic:.9}[e];return Math.max(i,a)}reachableBonus(e,t,n,o,i){const a=this.reachable(e,t,n,o),r=o?"magic":"energy";return{level:a,bonus:{normal:this.bonus(v[r][n],{...e,normal:a.normal}),evil:this.bonus(v[r][n],{...e,normal:i.e2n?Math.min(1e9,Number(e.normal)+a.evil-Number(e.evil)):e.normal,evil:a.evil}),sadistic:this.bonus(v[r][n],{...e,normal:i.s2e&&i.e2n?Math.min(1e9,Number(e.normal)+a.sadistic-Number(e.sadistic)):e.normal,evil:i.s2e?Math.min(1e9,Number(e.evil)+a.sadistic-Number(e.sadistic)):e.evil,sadistic:a.sadistic})}}}reachable(e,t,n,o){const i=o?"magic":"energy";return{normal:this.vreachable(Number(e.normal),t,1,v[i][n].normal.cost,i),evil:this.vreachable(Number(e.evil),t,1,v[i][n].evil.cost,i),sadistic:this.vreachable(Number(e.sadistic),t,1e7,v[i][n].sadistic.cost,i)}}bbtill(e,t,n,o,i){return o*i/n/e}vreachable(e,t,n,o,i){const a=this.ngustats[i].cap,r=this.speed(i);let c=t*60*50;const h=a*r/n/o;if(500*h>e)for(let g=1;g<501;g++){if(g*h>=e+Math.floor(c/g))return Math.min(1e9,e+Math.floor(c/g));Math.floor(g*h)>e&&(c-=g*(Math.floor(g*h)-e),e=Math.floor(g*h))}for(;c>0&&e<1e9;)c-=Math.ceil(o*(e+1)*n/(a*r)),e++;return c<0&&e--,Math.min(1e9,e)}}const U=j=>{if(j===""||j===void 0||j===null||isNaN(j))return"";let e=Number(j)*100;if(e<1e6)return e.toLocaleString(void 0,{maximumFractionDigits:0})+"%";const t=["Million","Billion","Trillion","Quadrillion","Quintillion","Sextillion","Septillion","Octillion","Nonillion","Decillion"];let n=Math.floor(Math.log10(e)/3),o=n-2;if(o<0)return e.toLocaleString(void 0,{maximumFractionDigits:0})+"%";if(o>=t.length)return e.toExponential(3)+"%";let i=t[o];return`${(e/Math.pow(10,n*3)).toLocaleString(void 0,{maximumFractionDigits:3})} ${i}%`};class V extends B.Component{constructor(e){super(e),this.state={sortConfig:{key:"reachable_level",direction:"descending"},timeUnit:"minutes",isReady:!1},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.requestSort=this.requestSort.bind(this)}componentDidMount(){setTimeout(()=>this.setState({isReady:!0}),300)}requestSort(e){let t="descending";this.state.sortConfig.key===e&&this.state.sortConfig.direction==="descending"&&(t="ascending"),this.setState({sortConfig:{key:e,direction:t}})}handleFocus(e){e.target.select()}handleSubmit(e){e.preventDefault()}handleChange(e,t,n=-1,o=-1){let i=e.target.value,a={...this.props.ngustats};if(n<0&&o<0){if(t==="e2n"||t==="s2e"){a={...a,quirk:{...a.quirk,[t]:!this.props.ngustats.quirk[t]}},this.props.handleSettings("ngustats",a);return}a={...a,[t]:i},a.ngutime>365*1440&&(a.ngutime=365*1440),this.props.handleSettings("ngustats",a);return}const r=o===1?"magic":"energy";if(n<0){a={...a,[r]:{...a[r],[t]:i}},this.props.handleSettings("ngustats",a);return}let c={...a[r].ngus},h={...c[n],[t]:i};c[n]=h,a={...a,[r]:{...a[r],ngus:c}},this.props.handleSettings("ngustats",a)}sortHandler(e){return()=>this.requestSort(e)}render(){if(!this.state.isReady)return s.jsx(G,{});H.pageview("/ngus/");let e=new z(this.props);const t=this.props.ngustats.energy,n=this.props.ngustats.magic,o=this.props.ngustats.ngutime,{key:i,direction:a}=this.state.sortConfig;return s.jsx(_,{sx:{display:"flex",flexDirection:"column",alignItems:"center",p:2},children:s.jsxs("form",{onSubmit:this.handleSubmit,children:[s.jsx(b,{container:!0,spacing:2,justifyContent:"center",sx:{mb:2},children:s.jsxs(b,{item:!0,xs:12,md:8,children:[s.jsx(k,{sx:{p:2},elevation:3,children:s.jsxs(b,{container:!0,spacing:2,children:[s.jsx(b,{item:!0,xs:6,sm:3,children:s.jsx(x,{label:"Energy cap",value:t.cap,onChange:r=>this.handleChange(r,"cap",-1,0),onFocus:this.handleFocus,type:"number",fullWidth:!0,inputProps:{step:"any"}})}),s.jsx(b,{item:!0,xs:6,sm:3,children:s.jsx(x,{label:"Energy NGU speed",value:t.nguspeed,onChange:r=>this.handleChange(r,"nguspeed",-1,0),onFocus:this.handleFocus,type:"number",fullWidth:!0,inputProps:{step:"any"},helperText:U(t.nguspeed)})}),s.jsx(b,{item:!0,xs:6,sm:3,children:s.jsx(x,{label:"Magic cap",value:n.cap,onChange:r=>this.handleChange(r,"cap",-1,1),onFocus:this.handleFocus,type:"number",fullWidth:!0,inputProps:{step:"any"}})}),s.jsx(b,{item:!0,xs:6,sm:3,children:s.jsx(x,{label:"Magic NGU speed",value:n.nguspeed,onChange:r=>this.handleChange(r,"nguspeed",-1,1),onFocus:this.handleFocus,type:"number",fullWidth:!0,inputProps:{step:"any"},helperText:U(n.nguspeed)})}),s.jsx(b,{item:!0,xs:12,sm:4,children:s.jsxs(_,{sx:{display:"flex",gap:1},children:[s.jsxs(W,{value:this.state.timeUnit,onChange:r=>this.setState({timeUnit:r.target.value}),size:"small",sx:{width:120},children:[s.jsx(F,{value:"minutes",children:"Minutes"}),s.jsx(F,{value:"hours",children:"Hours"})]}),s.jsx(x,{label:"NGU Time",value:this.state.timeUnit==="hours"?Math.round(o/60*100)/100:o,onChange:r=>{const c=Number(r.target.value),h=this.state.timeUnit==="hours"?c*60:c;this.handleChange({target:{value:h}},"ngutime")},onFocus:this.handleFocus,type:"number",fullWidth:!0,inputProps:{step:"any"}})]})}),s.jsx(b,{item:!0,xs:6,sm:4,children:s.jsx(L,{control:s.jsx(T,{checked:this.props.ngustats.quirk.e2n,onChange:r=>this.handleChange(r,"e2n")}),label:"Evil -> Normal Quirk"})}),s.jsx(b,{item:!0,xs:6,sm:4,children:s.jsx(L,{control:s.jsx(T,{checked:this.props.ngustats.quirk.s2e,onChange:r=>this.handleChange(r,"s2e")}),label:"Sadistic -> Evil Quirk"})})]})}),s.jsx(D,{...this.props,name:"ngustats",e:!0,m:!0,r:!1})]})}),s.jsx(k,{sx:{width:"100%",overflowX:"auto"},elevation:3,children:s.jsxs(E,{size:"small",children:[s.jsx(q,{children:s.jsxs(N,{children:[s.jsx(d,{children:s.jsx(f,{active:i==="name",direction:i==="name"?a==="ascending"?"asc":"desc":"asc",onClick:this.sortHandler("name"),children:"Name"})}),s.jsx(d,{children:s.jsx(f,{active:i==="normal",direction:i==="normal"?a==="ascending"?"asc":"desc":"asc",onClick:this.sortHandler("normal"),children:"Normal Level"})}),s.jsx(d,{children:s.jsx(f,{active:i==="evil",direction:i==="evil"?a==="ascending"?"asc":"desc":"asc",onClick:this.sortHandler("evil"),children:"Evil Level"})}),s.jsx(d,{children:s.jsx(f,{active:i==="sadistic",direction:i==="sadistic"?a==="ascending"?"asc":"desc":"asc",onClick:this.sortHandler("sadistic"),children:"Sadistic Level"})}),s.jsx(d,{children:s.jsx(f,{active:i==="bonus",direction:i==="bonus"?a==="ascending"?"asc":"desc":"asc",onClick:this.sortHandler("bonus"),children:"Current Bonus"})}),s.jsx(d,{children:s.jsxs(f,{active:i==="reachable_normal_change",direction:i==="reachable_normal_change"?a==="ascending"?"asc":"desc":"asc",onClick:this.sortHandler("reachable_normal_change"),children:["Reachable Normal Level",s.jsx("br",{}),"(Bonus Change)"]})}),s.jsx(d,{children:s.jsxs(f,{active:i==="reachable_evil_change",direction:i==="reachable_evil_change"?a==="ascending"?"asc":"desc":"asc",onClick:this.sortHandler("reachable_evil_change"),children:["Reachable Evil Level",s.jsx("br",{}),"(Bonus Change)"]})}),s.jsx(d,{children:s.jsxs(f,{active:i==="reachable_sadistic_change",direction:i==="reachable_sadistic_change"?a==="ascending"?"asc":"desc":"asc",onClick:this.sortHandler("reachable_sadistic_change"),children:["Reachable Sadistic Level",s.jsx("br",{}),"(Bonus Change)"]})})]})}),s.jsx(R,{children:["energy","magic"].map(r=>{const c=r==="magic"?1:0;let h=this.props.ngustats[r].ngus,g=v[r].map((p,u)=>{const y=e.bonus(p,h[u]),l=e.reachableBonus(h[u],o,u,c,this.props.ngustats.quirk);return{pos:u,ngu:p,name:p.name,normal:h[u].normal,evil:h[u].evil,sadistic:h[u].sadistic,bonus:y,reachable:l,reachable_level:l.level.normal,reachable_evil:l.level.evil,reachable_sadistic:l.level.sadistic,reachable_normal_change:l.bonus.normal/y,reachable_evil_change:l.bonus.evil/y,reachable_sadistic_change:l.bonus.sadistic/y}});this.state.sortConfig.key&&g.sort((p,u)=>p[this.state.sortConfig.key]<u[this.state.sortConfig.key]?this.state.sortConfig.direction==="ascending"?-1:1:p[this.state.sortConfig.key]>u[this.state.sortConfig.key]?this.state.sortConfig.direction==="ascending"?1:-1:0);const P=g.map(p=>{const{pos:u,ngu:y,bonus:l,reachable:m}=p;return s.jsxs(N,{children:[s.jsx(d,{component:"th",scope:"row",children:y.name}),s.jsx(d,{children:s.jsx(x,{type:"number",value:h[u].normal,onFocus:this.handleFocus,onChange:M=>this.handleChange(M,"normal",u,c),inputProps:{step:"any"},sx:{width:140},hiddenLabel:!0,size:"small"})}),s.jsx(d,{children:s.jsx(x,{type:"number",value:h[u].evil,onFocus:this.handleFocus,onChange:M=>this.handleChange(M,"evil",u,c),inputProps:{step:"any"},sx:{width:140},hiddenLabel:!0,size:"small"})}),s.jsx(d,{children:s.jsx(x,{type:"number",value:h[u].sadistic,onFocus:this.handleFocus,onChange:M=>this.handleChange(M,"sadistic",u,c),inputProps:{step:"any"},sx:{width:140},hiddenLabel:!0,size:"small"})}),s.jsx(d,{children:"×"+C(l*100)+"%"}),s.jsxs(d,{children:[C(m.level.normal)," (×",C(m.bonus.normal/l,4),") ",Math.round((m.bonus.normal/l-1)*100)!==0&&s.jsxs("span",{style:{color:"green",fontWeight:"bold"},children:["(",Math.abs((m.bonus.normal/l-1)*100%1)>.01?"~":"",Math.round((m.bonus.normal/l-1)*100),"%)"]})]}),s.jsxs(d,{children:[C(m.level.evil)," (×",C(m.bonus.evil/l,4),") ",Math.round((m.bonus.evil/l-1)*100)!==0&&s.jsxs("span",{style:{color:"green",fontWeight:"bold"},children:["(",Math.abs((m.bonus.evil/l-1)*100%1)>.01?"~":"",Math.round((m.bonus.evil/l-1)*100),"%)"]})]}),s.jsxs(d,{children:[C(m.level.sadistic)," (×",C(m.bonus.sadistic/l,4),") ",Math.round((m.bonus.sadistic/l-1)*100)!==0&&s.jsxs("span",{style:{color:"green",fontWeight:"bold"},children:["(",Math.abs((m.bonus.sadistic/l-1)*100%1)>.01?"~":"",Math.round((m.bonus.sadistic/l-1)*100),"%)"]})]})]},r+u)});return[s.jsx(N,{sx:{backgroundColor:"action.hover"},children:s.jsx(d,{colSpan:8,sx:{backgroundColor:"action.hover",typography:"subtitle1",fontWeight:700},children:r.charAt(0).toUpperCase()+r.slice(1)+" NGUs"})},r+"_header"),...P]})})]})})]})})}}export{V as default};
